---
title: TiDB Cloud Sysbench Performance Test Report for TiDB v7.5.0
summary: Introduce the Sysbench performance test results for a TiDB Dedicated cluster with the TiDB version of v7.5.0.
---

# TiDB Cloud Sysbench パフォーマンステストレポート for TiDB v7.5.0 {#tidb-cloud-sysbench-performance-test-report-for-tidb-v7-5-0}

このドキュメントは、TiDB Dedicated クラスターにおける TiDB バージョン v7.5.0 の Sysbench パフォーマンステストの手順と結果を提供します。このレポートは、TiDB Self-Hosted v7.5.0 クラスターのパフォーマンスの参考としても利用できます。

## テスト概要 {#test-overview}

このテストは、TiDB v7.5.0 の Sysbench パフォーマンスを、オンライントランザクション処理（OLTP）シナリオで示すことを目的としています。

## テスト環境 {#test-environment}

### TiDB クラスター {#tidb-cluster}

このテストは、以下の設定を持つ TiDB クラスターで実施されます:

-   クラスタータイプ: [TiDB Dedicated](/tidb-cloud/select-cluster-tier.md#tidb-dedicated)
-   クラスターバージョン: v7.5.0
-   クラウドプロバイダー: AWS (us-west-2)
-   クラスター構成:

    | ノードタイプ | ノードサイズ          | ノード数量 | ノードストレージ |
    | :----- | :-------------- | :---- | :------- |
    | TiDB   | 16 vCPU, 32 GiB | 2     | N/A      |
    | TiKV   | 16 vCPU, 64 GiB | 3     | 1000 GiB |

### パラメーター設定 {#parameter-configuration}

> **注意:**
>
> TiDB Cloud の場合、クラスターの TiKV パラメーターを変更するには、[PingCAP サポート](/tidb-cloud/tidb-cloud-support.md)に連絡してサポートを受けることができます。

TiKV パラメーター [`prefill-for-recycle`](https://docs.pingcap.com/tidb/stable/tikv-configuration-file#prefill-for-recycle-new-in-v700) は、初期化後すぐにログのリサイクルを効果的に行うことができます。このドキュメントでは、異なるワークロードに基づいて以下の `prefill-for-recycle` 設定でテストを実施します:

-   `oltp_point_select` ワークロードの場合、[`prefill-for-recycle`](https://docs.pingcap.com/tidb/stable/tikv-configuration-file#prefill-for-recycle-new-in-v700) パラメーターのデフォルト値を使用します:

    ```yaml
    raft-engine.prefill-for-recycle = false
    ```

-   `oltp_insert`, `oltp_read_write`, `oltp_update_index`, および `oltp_update_non_index` ワークロードの場合、[`prefill-for-recycle`](https://docs.pingcap.com/tidb/stable/tikv-configuration-file#prefill-for-recycle-new-in-v700) パラメーターを有効にします:

    ```yaml
    raft-engine.prefill-for-recycle = true
    ```

### ベンチマーク実行者 {#benchmark-executor}

ベンチマーク実行者は、SQL クエリを TiDB クラスターに送信します。このテストでは、そのハードウェア構成は以下の通りです:

-   マシンタイプ: Amazon EC2 (us-west-2)
-   インスタンスタイプ: c6a.2xlarge
-   Sysbench バージョン: sysbench 1.0.20 (bundled LuaJIT 2.1.0-beta2)

## テスト手順 {#test-steps}

このセクションでは、Sysbench パフォーマンステストの手順を段階的に紹介します。

1.  [TiDB Cloudコンソール](https://tidbcloud.com/)で、[テスト環境](#tidb-cluster)の要件を満たすTiDB専用クラスタを作成します。

    詳細については、[TiDB専用クラスタの作成](/tidb-cloud/create-tidb-cluster.md)を参照してください。

2.  ベンチマーク実行者で、新しく作成したクラスタに接続し、`sbtest`という名前のデータベースを作成します。

    クラスタに接続するには、[プライベートエンドポイントを介したTiDB専用への接続](/tidb-cloud/set-up-private-endpoint-connections.md)を参照してください。

    `sbtest`データベースを作成するには、次のSQLステートメントを実行します：

    ```sql
    CREATE DATABASE sbtest;
    ```

3.  `sbtest`データベースにSysbenchデータをロードします。

    1.  このドキュメントのテストは、[sysbench](https://github.com/akopytov/sysbench)に基づいて実装されています。sysbenchをインストールするには、[ソースからのビルドとインストール](https://github.com/akopytov/sysbench#building-and-installing-from-source)を参照してください。

    2.  次の`sysbench prepare`コマンドを実行して、32のテーブルと10,000,000行を`sbtest`データベースにインポートします。`${HOST}`、`${PORT}`、`${THREAD}`、`${PASSWORD}`を実際の値に置き換えてください。

        ```shell
        sysbench oltp_common \
           --threads=${THREAD} \
           --db-driver=mysql \
           --mysql-db=sbtest \
           --mysql-host=${HOST} \
           --mysql-port=${PORT} \
           --mysql-user=root \
           --mysql-password=${PASSWORD} \
           prepare --tables=32 --table-size=10000000
        ```

4.  次の`sysbench run`コマンドを実行して、さまざまなワークロードでSysbenchのパフォーマンステストを実施します。このドキュメントでは、`oltp_point_select`、`oltp_read_write`、`oltp_update_non_index`、`oltp_update_index`、`oltp_insert`の5つのワークロードでテストを実施します。各ワークロードについて、このドキュメントでは`${THREAD}`の値を`100`、`200`、`400`で3回テストを実施します。各並行性について、テストは20分間行います。

    ```shell
    sysbench ${WORKLOAD} run \
       --mysql-host=${HOST} \
       --mysql-port=${PORT} \
       --mysql-user=root \
       --db-driver=mysql \
       --mysql-db=sbtest \
       --threads=${THREAD} \
       --time=1200 \
       --report-interval=10 \
       --tables=32 \
       --table-size=10000000 \
       --mysql-ignore-errors=1062,2013,8028,9007 \
       --auto-inc=false \
       --mysql-password=${PASSWORD}
    ```

## テスト結果 {#test-results}

このセクションでは、[テスト環境](#test-environment)におけるv7.5.0のSysbenchパフォーマンスを紹介します。

### ポイント選択のパフォーマンス {#point-select-performance}

`oltp_point_select`ワークロードのパフォーマンスは次のとおりです：

| Threads | TPS     | 95% レイテンシ（ms） |
| :------ | :------ | :------------ |
| 100     | 64,810  | 2.03          |
| 200     | 118,651 | 2.22          |
| 400     | 153,580 | 3.96          |

![Sysbenchポイント選択のパフォーマンス](/media/tidb-cloud/v7.5.0_oltp_point_select.png)

### 読み書きのパフォーマンス {#read-write-performance}

`oltp_read_write`ワークロードのパフォーマンスは次のとおりです：

| Threads | TPS   | 95% レイテンシ（ms） |
| :------ | :---- | :------------ |
| 100     | 2,134 | 54.8          |
| 200     | 3,020 | 99.3          |
| 400     | 3,251 | 193           |

![Sysbench読み書きのパフォーマンス](/media/tidb-cloud/v7.5.0_oltp_read_write.png)

### インデックスのない更新のパフォーマンス {#update-non-index-performance}

`oltp_update_non_index`ワークロードのパフォーマンスは次のとおりです：

| Threads | TPS    | 95% レイテンシ（ms） |
| :------ | :----- | :------------ |
| 100     | 10,567 | 11.7          |
| 200     | 20,223 | 13.0          |
| 400     | 34,011 | 14.7          |

![Sysbenchインデックスのない更新のパフォーマンス](/media/tidb-cloud/v7.5.0_oltp_update_non_index.png)

### インデックスの更新のパフォーマンス {#update-index-performance}

`oltp_update_index`ワークロードのパフォーマンスは次のとおりです：

| Threads | TPS    | 95% latency (ms) |
| :------ | :----- | :--------------- |
| 100     | 8,896  | 14.7             |
| 200     | 1,3718 | 19.0             |
| 400     | 2,0377 | 26.9             |

![Sysbench update index performance](/media/tidb-cloud/v7.5.0_oltp_update_index.png)

### Insert performance {#insert-performance}

The performance on the `oltp_insert` workload is as follows:

| Threads | TPS    | 95% latency (ms) |
| :------ | :----- | :--------------- |
| 100     | 15,132 | 8.58             |
| 200     | 24,756 | 10.8             |
| 400     | 37,247 | 16.4             |

![Sysbench insert performance](/media/tidb-cloud/v7.5.0_oltp_insert.png)
